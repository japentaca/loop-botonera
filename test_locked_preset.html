<!DOCTYPE html>
<html>

<head>
  <title>Test Locked Preset Storage</title>
  <style>
    body {
      font-family: monospace;
      padding: 20px;
    }

    .test-section {
      margin: 20px 0;
      padding: 10px;
      border: 1px solid #ccc;
    }

    pre {
      background: #f5f5f5;
      padding: 10px;
      overflow-x: auto;
    }
  </style>
</head>

<body>
  <h1>Test Locked Preset Storage</h1>
  <div class="test-section">
    <h2>Test 1: Check LocalStorage</h2>
    <button onclick="checkLocalStorage()">Check LocalStorage</button>
    <div id="storage-result"></div>
  </div>

  <div class="test-section">
    <h2>Test 2: Check Current Metadata Structure</h2>
    <button onclick="checkMetadataStructure()">Check Metadata Structure</button>
    <div id="metadata-result"></div>
  </div>

  <script>
    function checkLocalStorage() {
      const storage = localStorage.getItem('loopera_presets');
      const result = document.getElementById('storage-result');

      if (!storage) {
        result.innerHTML = '<p>No presets found in localStorage</p>';
        return;
      }

      try {
        const presets = JSON.parse(storage);
        result.innerHTML = `
                    <p>Found ${presets.length} presets</p>
                    <h3>First preset structure:</h3>
                    <pre>${JSON.stringify(presets[0], null, 2)}</pre>
                `;
      } catch (e) {
        result.innerHTML = `<p>Error parsing localStorage: ${e.message}</p>`;
      }
    }

    function checkMetadataStructure() {
      // This would need to be run in the actual app context
      // For now, just show the expected structure
      const expectedStructure = {
        "id": 0,
        "isActive": true,
        "scale": "major",
        "baseNote": 60,
        "length": 16,
        "octaveRange": 2,
        "density": 0,
        "lastModified": 1234567890,
        "noteRangeMin": 24,
        "noteRangeMax": 96,
        "patternProbabilities": {
          "euclidean": 0.3,
          "arpeggio": 0.3,
          "random": 0.4
        },
        "generationMode": "auto",  // <- This should be 'auto' or 'locked'
        "lastPattern": null
      };

      document.getElementById('metadata-result').innerHTML = `
                <h3>Expected Loop Metadata Structure:</h3>
                <pre>${JSON.stringify(expectedStructure, null, 2)}</pre>
                <p><strong>Important:</strong> The "generationMode" field should be saved and loaded with presets.</p>
            `;
    }
  </script>
</body>

</html>